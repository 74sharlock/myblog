"use strict";(function(b,a){if(!b.document){throw new Error("本方法只能在dom环境下使用...")}if(typeof define==="function"){define("$tpl",["jquery"],a)}else{a(b)}})((typeof window!=="undefined"?window:this),function(){var jQuery=window.jQuery||(arguments[0]?arguments[0]("jquery"):undefined);return(function($){if(typeof $==="undefined"){throw new Error("本方法依赖jQuery...")}var toString=Object.prototype.toString,fnParse=window.eval;$.tpl=function(dataList,jqueryObject,queryAttrName,useLowCase){var i,len,item,html;html="";queryAttrName=(queryAttrName||"data-query");for(i=0,len=dataList.length;i<len;i+=1){if(useLowCase===true){item={};for(var k in dataList[i]){item[k.toLowerCase()]=dataList[i][k]}}else{item=dataList[i]}html+=queryData(item,jqueryObject,queryAttrName,i).html()}return html};$.tpl.queryData=queryData;$.tpl.version="0.1.0";function queryData(item,$scope,queryAttrName,index){if($scope.length){$scope=$("<div>"+$scope.prop("outerHTML")+"</div>")}queryAttrName=(queryAttrName||"data-query");var $queryElements=$("["+queryAttrName+"]",$scope);var l=$queryElements.length,key;while(l--){var $queryElement=$queryElements.eq(l);var queryArr=$queryElement.attr(queryAttrName).split(","),queryArrlen=queryArr.length;while(queryArrlen--){var queryItem=queryArr[queryArrlen],queryItemArr,method,attrJson;if(queryItem.indexOf("{")>=0){queryItemArr=queryItem.split("{");method=queryItemArr[0].replace(":","");queryItemArr=queryItemArr[1].replace("}","").split("|");attrJson={};var m=queryItemArr.length;while(m--){var qArr=queryItemArr[m].split(":");if(qArr[1].indexOf("->")>=0){qArr[1]=qArr[1].replace("->","").replace("??",":");qArr[1]=fnParse("(function($data,$index){return "+qArr[1]+";})("+JSON.stringify(item)+", "+index+")");attrJson[qArr[0]]=qArr[1]}else{if(item.hasOwnProperty(qArr[1])){if(toString.call(item[qArr[1]])==="[object Undefined]"||toString.call(item[qArr[1]])==="[object Null]"){item[qArr[1]]=""}attrJson[qArr[0]]=item[qArr[1]]}else{throw new Error("没有在数据中找到"+qArr[1]+"字段,请仔细核对数据.注意字段的大小写.")}}}$queryElement[method](attrJson)}else{queryItemArr=queryItem.split(":");method=queryItemArr[0];key=queryItemArr[1];if(key.indexOf("->")>=0){item[key]=fnParse("(function($data,$index){return "+key.replace("->","").replace("??",":")+";})("+JSON.stringify(item)+", "+index+")")}else{if(item.hasOwnProperty(key)){if(toString.call(item[key])==="[object Undefined]"||toString.call(item[key])==="[object Null]"){item[key]=""}}else{throw new Error("没有在数据中找到"+key+"字段,请仔细核对数据.注意字段的大小写.")}}$queryElement[method](String(item[key]))}}}return $scope}return $.tpl})(jQuery)});